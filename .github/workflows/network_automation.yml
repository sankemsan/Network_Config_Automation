name: Network Multi-devices Automation
on: 
  workflow_dispatch: # Manual trigger
  push:
   branches:
    - main 
jobs:
  automate:
   runs-on: ubuntu-latest
   steps:
    - name: Checkout Respository
      uses: actions/checkout@v3
    - name: Set up Python
      uses: action/setup-python@v4
      with:
        python-version: '3.10'
    - name: Install Dependencies
      run: | 
        python -m pip install --upgrade pip
        pip install netmiko
    - name: Run Netmiko Multi-Device Script
      env:
        DEVICES_JSON: ${{secrets.DEVICES_JSON}}
      run: | 
        echo "$DEVICES_JSON" > devices.json
        python automation_multi.py 

